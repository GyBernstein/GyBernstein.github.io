---
layout: post
title:  "Java 函数式编程 I"
date:   2019-01-11
excerpt: "一种区别于面向过程、面向对象的编程范式"
tag:
- java 
- functional
- Functional Programming
- tobe
comments: false
---

这里不再对函数进行解释。

## λ   
λ 演算： 基于λ 项，λ 项是 λ 演算的基本单元，λ 演算在 λ 项上定义了各种转换规则。  
两个特征：  
* λ 演算中的函数都是匿名的。比如sum(x, y) = x + y 可以写成(x, y)| -> x + y.  
* λ 演算中的函数都只有一个输入。有多个输入的函数可以通过柯里化来转换成多个只包含一个输入的函数的嵌套调用。  

λ 项，这里不想介绍其具体定义，简单来说可以这样理解，可作为一个函数传入的变量或者函数都可以称为 λ 项，这和上面有点互相解释了。

### 绑定变量和自由变量
简单点说，绑定变量是作为函数的入参，而自由变量不是函数的入参。所以自由变量会引起副作用，这个后面会介绍。

### 约简
分为 α 变换、β 约简、η 变换，虽然在我眼中没有什么太大的区别，就是一直进一步地说同一件事情，说明函数的变量可替换，变量可以是函数，可以化简。
* α 变换的目的是改变绑定变量的名称，避免命名冲突（这个在java stream中无所谓，都是柯里化过的，随便重名）。
* β 约简就是替换变量，替换的基本原则是要求在替换完成之后，原来的自由变量仍然是自由的，要做到这一点，经常要先进行 α 变换。
* η 变换描述函数的外延性（extensionality）。外延性指的是如果两个函数当且仅当对所有参数的结果相同时，才被认为是相等的。

## 纯函数、副作用和引用透明性
纯函数的两个特征：
* 对于相同的输入参数，总是返回相同的值。  
* 求值过程中不产生副作用，也就是不会对运行环境产生影响。  
如果一个表达式是纯的，那么它在代码中的所有出现，都可以用它的值来代替。对于一个函数调用来说，这就意味着，对于同一个函数的输入参数相同的调用，都可以用其值来代替。这就是函数的引用透明性。

## 函数式编程  
函数式编程是一种编程范式。它把计算当成是数学函数的求值，从而避免改变状态和使用可变数据。它是一种声明式的编程范式，通过表达式和声明而不是语句来编程。   
函数式编程的一个特点就是，允许把函数本身作为参数传入另一个函数，还允许返回一个函数！  
 
## 意义  
* 多线程（无状态特性）  
* 提高代码复用性  


## 函数类型与高阶函数  
java类库中提供的几个函数：  
* Function<T,R>：接受一个参数的函数，输入类型为T，输出类型为R。Function接口只包含一个抽象方法 R apply(T t)。  
* BiFunction<T,U,R>：接受两个参数的函数，T和U分别是两个参数的类型，R是输出类型。抽象方法 R apply(T t, U u)。  
* Consumer<T>：接受一个输入，没有输出。抽象方法 void accept(T t)。  
* Supplier<T>：没有输入，一个输出。抽象方法 T get()。  
* Predicate<T>：接受一个输入，输出为boolean类型。抽象方法 boolean test(T t)。  
* UnaryOperator<T>：接受一个输入，输出的类型与输入相同，相当于Function<T,T>。  
* BinaryOperator<T>：接受两个类型相同的输入，输出的类型与输入相同，相当于BiFunction<T,T,T>。  
* BiPredicate<T,U>：接受两个输入，输出为boolean类型。抽象方法为boolean test(T t, U u)。  

配合stream中方法简单说明一下。  
filter() 接收Predicate类型的参数。  
foreach() 接收Consumer类型的参数。  

高阶函数示例
~~~ java
public class HighOrderFunctions {
    private static <T> Predicate<T> notEqual(T t) {
         return (v) -> !Objects.equals(v, t);
    }
​
    public static void main(String[] args) {
       List.of(1, 2, 3)
           .stream()
           .filter(notEqual(1))
           .forEach(System.out::println);
    }
}
~~~

## 部分函数
部分函数是指仅有部分输入参数被绑定了实际值的函数。  
示例：fa(b, c) 即为部分函数  
~~~ java
function f(a, b, c) {
  return a + b + c;
}
​
function fa(b, c) {
  return f(1, b, c);
}
~~~

## 柯里化  
柯里化（currying）是与λ演算相关的重要概念。通过柯里化，可以把有多个输入的函数转换成只有一个输入的函数，从而可以在λ演算中来表示。  

柯里化与部分函数存在一定的关联，但两者是有区别的。部分函数的求值结果永远是实际的函数调用结果；而柯里化函数的求值结果则可能是另外一个函数。  

## 闭包  
当一个函数作为返回值，并且该函数内部使用了出现在其所在函数的词法域（lexical scope）的自由变量时，就创建了一个闭包。

